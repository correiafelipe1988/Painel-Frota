(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[744],{9041:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]])},39018:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>S});var s=t(95155),r=t(12115),n=t(23169),i=t(49551),l=t(66695),o=t(59409),c=t(30285),d=t(17313),h=t(60679),x=t(98328),m=t(5263),u=t(80659),p=t(9041),j=t(99591),v=t(53647),y=t(79457),g=t(87481),k=t(83540),f=t(93504),N=t(96025),b=t(16238),M=t(94517),R=t(21374),C=t(3401),A=t(83394);let w=new Date().getFullYear(),Y=Array.from({length:3},(e,a)=>({value:(w-a).toString(),label:(w-a).toString()}));function S(){let[e,a]=(0,r.useState)([]),[t,S]=(0,r.useState)(!0),[P,W]=(0,r.useState)(w.toString()),[K,D]=(0,r.useState)((w-1).toString()),{toast:L}=(0,g.dj)();(0,r.useEffect)(()=>{S(!0);let e=(0,j.Ef)(e=>{Array.isArray(e)?a(e):(console.warn("Data from subscribeToMotorcycles (analise temporal) was not an array:",e),a([])),S(!1)});return()=>e()},[]);let I=(0,r.useMemo)(()=>{if(t||!Array.isArray(e))return{currentYearData:[],comparisonYearData:[],seasonalData:[],yearOverYearComparison:[],currentYearKPIs:{totalWeeklyRevenue:0,totalMonthlyRevenue:0,averageRevenuePerFranchisee:0,totalRentedMotorcycles:0,financialOccupationRate:0,revenueGrowth:0,averageTicketPerMoto:0},comparisonYearKPIs:{totalWeeklyRevenue:0,totalMonthlyRevenue:0,averageRevenuePerFranchisee:0,totalRentedMotorcycles:0,financialOccupationRate:0,revenueGrowth:0,averageTicketPerMoto:0}};let a=(0,v.kW)(e,parseInt(P)),s=(0,v.kW)(e,parseInt(K)),r=(0,v.Ju)(e),n=e.filter(e=>{if(!e.data_ultima_mov)return!1;try{return new Date(e.data_ultima_mov).getFullYear()===parseInt(P)}catch(e){return!1}}),i=e.filter(e=>{if(!e.data_ultima_mov)return!1;try{return new Date(e.data_ultima_mov).getFullYear()===parseInt(K)}catch(e){return!1}}),l=(0,v.l)(n),o=(0,v.l)(i),c=a.map((e,a)=>{let t=s[a],r=t&&t.revenue>0?(e.revenue-t.revenue)/t.revenue*100:0;return{month:e.month,currentYear:e.revenue,comparisonYear:t?t.revenue:0,growth:r,currentYearMotos:e.motorcycleCount,comparisonYearMotos:t?t.motorcycleCount:0}});return{currentYearData:a,comparisonYearData:s,seasonalData:r,yearOverYearComparison:c,currentYearKPIs:l,comparisonYearKPIs:o}},[e,P,K,t]),T=e=>"R$ ".concat(e.toLocaleString("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0})),_=e=>"".concat(e.toFixed(1),"%"),z=(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(o.l6,{value:P,onValueChange:W,children:[(0,s.jsx)(o.bq,{className:"w-[120px]",children:(0,s.jsx)(o.yv,{placeholder:"Ano Principal"})}),(0,s.jsx)(o.gC,{children:Y.map(e=>(0,s.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)(o.l6,{value:K,onValueChange:D,children:[(0,s.jsx)(o.bq,{className:"w-[120px]",children:(0,s.jsx)(o.yv,{placeholder:"Comparar com"})}),(0,s.jsx)(o.gC,{children:Y.map(e=>(0,s.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)(c.$,{onClick:()=>{L({title:"Funcionalidade em Desenvolvimento",description:"A exporta\xe7\xe3o de an\xe1lise temporal ser\xe1 implementada em breve."})},variant:"default",className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,s.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Exportar"]})]});return t?(0,s.jsxs)(n.DashboardLayout,{children:[(0,s.jsx)(i.z,{title:"An\xe1lise Temporal",description:"Evolu\xe7\xe3o da receita ao longo do tempo",actions:z}),(0,s.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,s.jsx)("p",{children:"Carregando an\xe1lise temporal..."})})]}):(0,s.jsxs)(n.DashboardLayout,{children:[(0,s.jsx)(i.z,{title:"An\xe1lise Temporal",description:"Evolu\xe7\xe3o da receita ao longo do tempo",icon:x.A,iconContainerClassName:"bg-purple-600",actions:z}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-4 mt-6",children:[(0,s.jsx)(l.Zp,{children:(0,s.jsx)(l.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Receita Total ",P]}),(0,s.jsx)("p",{className:"text-lg font-bold text-green-600",children:T(I.currentYearKPIs.totalWeeklyRevenue)}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[K,": ",T(I.comparisonYearKPIs.totalWeeklyRevenue)]})]})})}),(0,s.jsx)(l.Zp,{children:(0,s.jsx)(l.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Motos Ativas ",P]}),(0,s.jsx)("p",{className:"text-lg font-bold text-blue-600",children:I.currentYearKPIs.totalRentedMotorcycles}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[K,": ",I.comparisonYearKPIs.totalRentedMotorcycles]})]})})}),(0,s.jsx)(l.Zp,{children:(0,s.jsx)(l.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Ticket M\xe9dio ",P]}),(0,s.jsx)("p",{className:"text-lg font-bold text-purple-600",children:T(I.currentYearKPIs.averageTicketPerMoto)}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[K,": ",T(I.comparisonYearKPIs.averageTicketPerMoto)]})]})})}),(0,s.jsx)(l.Zp,{children:(0,s.jsx)(l.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Ocupa\xe7\xe3o ",P]}),(0,s.jsx)("p",{className:"text-lg font-bold text-orange-600",children:_(I.currentYearKPIs.financialOccupationRate)}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[K,": ",_(I.comparisonYearKPIs.financialOccupationRate)]})]})})})]}),(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsxs)(d.tU,{defaultValue:"monthly",className:"space-y-6",children:[(0,s.jsxs)(d.j7,{className:"grid w-full grid-cols-3",children:[(0,s.jsx)(d.Xi,{value:"monthly",children:"An\xe1lise Mensal"}),(0,s.jsx)(d.Xi,{value:"comparison",children:"Compara\xe7\xe3o Anual"}),(0,s.jsx)(d.Xi,{value:"seasonal",children:"Sazonalidade"})]}),(0,s.jsx)(d.av,{value:"monthly",className:"space-y-6",children:(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.A,{className:"h-6 w-6 text-green-600"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(l.ZB,{className:"font-headline",children:["Evolu\xe7\xe3o Mensal da Receita (",P,")"]}),(0,s.jsx)(l.BT,{children:"Receita semanal, quantidade de motos e ticket m\xe9dio por m\xeas"})]})]})}),(0,s.jsx)(l.Wu,{children:(0,s.jsx)(y.U,{data:I.currentYearData,year:parseInt(P)})})]})}),(0,s.jsxs)(d.av,{value:"comparison",className:"space-y-6",children:[(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-6 w-6 text-blue-600"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(l.ZB,{className:"font-headline",children:["Compara\xe7\xe3o ",P," vs ",K]}),(0,s.jsx)(l.BT,{children:"Evolu\xe7\xe3o da receita entre os anos selecionados"})]})]})}),(0,s.jsx)(l.Wu,{children:(0,s.jsx)(k.u,{width:"100%",height:400,children:(0,s.jsxs)(f.b,{data:I.yearOverYearComparison,margin:{top:20,right:30,left:20,bottom:5},children:[(0,s.jsx)(N.W,{dataKey:"month",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,s.jsx)(b.h,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:T}),(0,s.jsx)(M.m,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},formatter:(e,a)=>[T(e),a]}),(0,s.jsx)(R.N,{type:"monotone",dataKey:"currentYear",name:P,stroke:"hsl(142.1 76.2% 36.3%)",strokeWidth:3,dot:{r:4}}),(0,s.jsx)(R.N,{type:"monotone",dataKey:"comparisonYear",name:K,stroke:"hsl(221.2 83.2% 53.3%)",strokeWidth:3,strokeDasharray:"5 5",dot:{r:4}})]})})})]}),(0,s.jsxs)(l.Zp,{children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsx)(l.ZB,{children:"Crescimento Mensal (%)"}),(0,s.jsxs)(l.BT,{children:["Varia\xe7\xe3o percentual de ",P," em rela\xe7\xe3o a ",K]})]}),(0,s.jsx)(l.Wu,{children:(0,s.jsx)(k.u,{width:"100%",height:300,children:(0,s.jsxs)(C.E,{data:I.yearOverYearComparison,margin:{top:20,right:30,left:20,bottom:5},children:[(0,s.jsx)(N.W,{dataKey:"month",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,s.jsx)(b.h,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>"".concat(e,"%")}),(0,s.jsx)(M.m,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"8px"},formatter:e=>["".concat(e.toFixed(1),"%"),"Crescimento"]}),(0,s.jsx)(A.y,{dataKey:"growth",fill:"hsl(142.1 76.2% 36.3%)",radius:[4,4,0,0]})]})})})]})]}),(0,s.jsx)(d.av,{value:"seasonal",className:"space-y-6",children:(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.A,{className:"h-6 w-6 text-purple-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ZB,{className:"font-headline",children:"An\xe1lise de Sazonalidade"}),(0,s.jsx)(l.BT,{children:"Padr\xf5es de receita m\xe9dia por m\xeas (todos os anos)"})]})]})}),(0,s.jsx)(l.Wu,{children:(0,s.jsx)(k.u,{width:"100%",height:350,children:(0,s.jsxs)(C.E,{data:I.seasonalData,margin:{top:20,right:30,left:20,bottom:5},children:[(0,s.jsx)(N.W,{dataKey:"month",stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1}),(0,s.jsx)(b.h,{stroke:"#888888",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:T}),(0,s.jsx)(M.m,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"8px"},formatter:(e,a)=>"Receita M\xe9dia"===a?[T(e),a]:[e,a]}),(0,s.jsx)(A.y,{dataKey:"averageRevenue",name:"Receita M\xe9dia",fill:"hsl(262.1 83.3% 57.8%)",radius:[4,4,0,0]})]})})})]})})]})})]})}},52173:(e,a,t)=>{Promise.resolve().then(t.bind(t,39018))},93504:(e,a,t)=>{"use strict";t.d(a,{b:()=>o});var s=t(51649),r=t(21374),n=t(96025),i=t(16238),l=t(83455),o=(0,s.gu)({chartName:"LineChart",GraphicalChild:r.N,axisComponents:[{axisType:"xAxis",AxisComp:n.W},{axisType:"yAxis",AxisComp:i.h}],formatAxisMap:l.pr})},98328:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])}},e=>{var a=a=>e(e.s=a);e.O(0,[992,73,207,851,880,508,122,228,168,249,382,925,169,199,321,441,684,358],()=>a(52173)),_N_E=e.O()}]);