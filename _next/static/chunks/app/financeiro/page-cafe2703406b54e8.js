(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[621],{48822:(e,a,t)=>{Promise.resolve().then(t.bind(t,77025))},77025:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>J});var s=t(95155),r=t(12115),l=t(23169),n=t(49551),i=t(66695),o=t(59409),c=t(30285),d=t(17313),m=t(60679),u=t(88390),x=t(80659),h=t(81203),j=t(40157);let p=(0,j.A)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var g=t(99591),b=t(53647),f=t(50286),N=t(78071),v=t(59434);let y=e=>"R$ ".concat(e.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})),A=e=>"".concat(e.toFixed(1),"%");function R(e){let{kpis:a,isLoading:t=!1}=e;if(t)return(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:Array.from({length:7}).map((e,a)=>(0,s.jsxs)(i.Zp,{className:"animate-pulse",children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24"}),(0,s.jsx)("div",{className:"h-4 w-4 bg-gray-200 rounded"})]}),(0,s.jsxs)(i.Wu,{children:[(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-20 mb-1"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-32"})]})]},a))});let r=[{title:"Receita Semanal Total",value:y(a.totalWeeklyRevenue),description:"Soma de todas as motos alugadas",icon:u.A,color:"text-green-600",bgColor:"bg-green-100"},{title:"Receita Mensal Projetada",value:y(a.totalMonthlyRevenue),description:"Baseada na receita semanal atual",icon:p,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Receita M\xe9dia por Franqueado",value:y(a.averageRevenuePerFranchisee),description:"Distribui\xe7\xe3o por franqueado",icon:f.A,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Motos Gerando Receita",value:a.totalRentedMotorcycles.toString(),description:"Alugadas + Relocadas",icon:N.A,color:"text-indigo-600",bgColor:"bg-indigo-100"},{title:"Taxa de Ocupa\xe7\xe3o Financeira",value:A(a.financialOccupationRate),description:"% de motos gerando receita",icon:h.A,color:a.financialOccupationRate>=85?"text-green-600":a.financialOccupationRate>=75?"text-yellow-600":"text-red-600",bgColor:a.financialOccupationRate>=85?"bg-green-100":a.financialOccupationRate>=75?"bg-yellow-100":"bg-red-100"},{title:"Ticket M\xe9dio por Moto",value:y(a.averageTicketPerMoto),description:"Valor semanal m\xe9dio",icon:p,color:"text-teal-600",bgColor:"bg-teal-100"},{title:"Receita L\xedquida por Moto",value:y(a.receitaLiquidaPorMoto),description:"Valor real baseado no DRE",icon:p,color:"text-green-600",bgColor:"bg-green-100"}];return(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:r.map((e,a)=>(0,s.jsxs)(i.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(i.ZB,{className:"text-sm font-medium text-muted-foreground",children:e.title}),(0,s.jsx)("div",{className:(0,v.cn)("p-2 rounded-full",e.bgColor),children:(0,s.jsx)(e.icon,{className:(0,v.cn)("h-4 w-4",e.color)})})]}),(0,s.jsxs)(i.Wu,{children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:(0,v.cn)("text-2xl font-bold",e.color),children:e.value}),6===a?null:"badge"in e?e.badge:null]}),(0,s.jsx)(i.BT,{className:"text-xs text-muted-foreground mt-1",children:e.description})]})]},a))})}var w=t(85127),M=t(26126);let k=(0,j.A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var O=t(77070);let S=(0,j.A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),F=[{value:1,label:"Janeiro",short:"Jan"},{value:2,label:"Fevereiro",short:"Fev"},{value:3,label:"Mar\xe7o",short:"Mar"},{value:4,label:"Abril",short:"Abr"},{value:5,label:"Maio",short:"Mai"},{value:6,label:"Junho",short:"Jun"},{value:7,label:"Julho",short:"Jul"},{value:8,label:"Agosto",short:"Ago"},{value:9,label:"Setembro",short:"Set"},{value:10,label:"Outubro",short:"Out"},{value:11,label:"Novembro",short:"Nov"},{value:12,label:"Dezembro",short:"Dez"}],q=e=>"R$ ".concat(e.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})),C=e=>"".concat(e.toFixed(1),"%");function T(e){let{motorcycles:a,selectedYear:t}=e,[l,n]=(0,r.useState)("all"),[d,m]=(0,r.useState)(!1),u=(0,r.useMemo)(()=>[{value:"all",label:"Todos os Franqueados"},...Array.from(new Set(a.filter(e=>e.franqueado&&""!==e.franqueado.trim()).map(e=>e.franqueado.trim()))).sort().map(e=>({value:e,label:e}))],[a]),h=(0,r.useMemo)(()=>{let e=parseInt(t),s=new Date,r=s.getFullYear(),n=s.getMonth()+1,i=e===r?n:12,o=[];for(let t=1;t<=i;t++){let s=a.filter(a=>{if(!a.data_ultima_mov)return"alugada"===a.status;try{let s=new Date(a.data_ultima_mov),r=s.getFullYear(),l=s.getMonth()+1;if(r===e&&l===t)return!0;if(r<e||r===e&&l<t)return"alugada"===a.status;return!1}catch(e){return!1}}),r=s;"all"!==l&&(r=s.filter(e=>{var a;return(null==(a=e.franqueado)?void 0:a.trim())===l}));let n=4.33*(0,b.VH)(r,e,t).reduce((e,a)=>e+a.weeklyRevenue,0);"all"!==l?a.filter(e=>{var a;return(null==(a=e.franqueado)?void 0:a.trim())===l}).length:a.length,r.filter(a=>{if("alugada"!==a.status||!a.data_ultima_mov)return!1;try{let s=new Date(a.data_ultima_mov),r=s.getFullYear(),l=s.getMonth()+1;return r===e&&l===t}catch(e){return!1}}).length,r.filter(a=>{if(!a.data_ultima_mov)return!1;try{let s=new Date(a.data_ultima_mov),r=s.getFullYear(),l=s.getMonth()+1;return r===e&&l===t}catch(e){return!1}}).length;let i=n>0,c=new Set(r.map(e=>e.placa)).size,d=r.reduce((a,s)=>{if(!s.data_ultima_mov)return a;try{let r=new Date(s.data_ultima_mov),l=r.getFullYear(),n=r.getMonth()+1;if(l===e&&n===t&&"alugada"===s.status)return a+(s.caucao||0);return a}catch(e){return a}},0),m=i?212*Math.floor(c/10):0,u={caucao:d,juros:m,cobrancaLocatario:0,total:d+m},x=n+u.total,h=.07*x,j={simplesNacional:h,total:h},p=i?139.9*c:0,g=i?250*c:0,f=.05*n,N=300*!!i,v=80*!!i,y=600*!!i,A={seguroRastreador:p,manutencao:0,taxaEspaco:g,royalties:f,ipvaTaxas:0,fundoMarketing:N,sistemaGestao:v,honorariosContabeis:y,total:p+0+g+f+0+N+v+y},R=n+u.total,w=x-j.total-A.total,M=x>0?w/x*100:0,k=c>0?w/c:0;o.push({month:F[t-1].short,monthNumber:t,receita:n,receitasNaoOperacionais:u,receitaBruta:R,tributosReceitas:j,custosOperacionais:A,lucroLiquido:w,margemLiquida:M,receitaLiquidaPorMoto:k})}return o},[a,t,l]),j=(0,r.useMemo)(()=>h.reduce((e,a)=>({receita:e.receita+a.receita,receitasNaoOperacionais:e.receitasNaoOperacionais+a.receitasNaoOperacionais.total,receitaBruta:e.receitaBruta+a.receitaBruta,tributosReceitas:e.tributosReceitas+a.tributosReceitas.total,custosOperacionais:e.custosOperacionais+a.custosOperacionais.total,lucroLiquido:e.lucroLiquido+a.lucroLiquido}),{receita:0,receitasNaoOperacionais:0,receitaBruta:0,tributosReceitas:0,custosOperacionais:0,lucroLiquido:0}),[h]),p=j.receita+j.receitasNaoOperacionais,g=p>0?j.lucroLiquido/p*100:0;return(0,s.jsxs)(i.Zp,{children:[(0,s.jsx)(i.aR,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(k,{className:"h-6 w-6 text-blue-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{className:"font-headline",children:"DRE - Demonstrativo de Resultado do Exerc\xedcio"}),(0,s.jsxs)(i.BT,{children:["An\xe1lise mensal de receitas, custos e resultado l\xedquido - ",t]})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(o.l6,{value:l,onValueChange:n,children:[(0,s.jsx)(o.bq,{className:"w-[250px]",children:(0,s.jsx)(o.yv,{placeholder:"Selecionar franqueado"})}),(0,s.jsx)(o.gC,{children:u.map(e=>(0,s.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]})})]})}),(0,s.jsxs)(i.Wu,{children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(w.XI,{children:[(0,s.jsx)(w.A0,{children:(0,s.jsxs)(w.Hj,{children:[(0,s.jsx)(w.nd,{className:"font-semibold",children:"Conta"}),h.map(e=>(0,s.jsx)(w.nd,{className:"text-center font-semibold min-w-[100px]",children:e.month},e.monthNumber)),(0,s.jsxs)(w.nd,{className:"text-center font-semibold bg-gray-50 min-w-[120px]",children:["Total ",t]})]})}),(0,s.jsxs)(w.BF,{children:[(0,s.jsxs)(w.Hj,{className:"bg-green-50",children:[(0,s.jsx)(w.nA,{className:"font-semibold text-green-700",children:"Receita Operacional"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-green-700 font-medium",children:q(e.receita)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-green-700 bg-green-100",children:q(j.receita)})]}),(0,s.jsxs)(w.Hj,{className:"bg-green-25",children:[(0,s.jsx)(w.nA,{className:"font-semibold text-green-600 pl-4",children:"(+) Cau\xe7\xe3o"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-green-600",children:q(e.receitasNaoOperacionais.caucao)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-green-600 bg-gray-50",children:q(h.reduce((e,a)=>e+a.receitasNaoOperacionais.caucao,0))})]}),(0,s.jsxs)(w.Hj,{className:"bg-green-25",children:[(0,s.jsx)(w.nA,{className:"font-semibold text-green-600 pl-4",children:"(+) Juros"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-green-600",children:q(e.receitasNaoOperacionais.juros)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-green-600 bg-gray-50",children:q(h.reduce((e,a)=>e+a.receitasNaoOperacionais.juros,0))})]}),(0,s.jsxs)(w.Hj,{className:"bg-green-100 border-t-2 border-green-300",children:[(0,s.jsx)(w.nA,{className:"font-bold text-green-800",children:"RECEITA BRUTA"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center font-bold text-green-800",children:q(e.receitaBruta)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-green-800 bg-green-200",children:q(h.reduce((e,a)=>e+a.receitaBruta,0))})]}),(0,s.jsxs)(w.Hj,{className:"bg-red-50",children:[(0,s.jsx)(w.nA,{className:"font-semibold text-red-600",children:"(-) Simples Nacional"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-red-600",children:q(e.tributosReceitas.simplesNacional)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-red-600 bg-red-100",children:q(j.tributosReceitas)})]}),(0,s.jsxs)(w.Hj,{className:"bg-orange-50",children:[(0,s.jsx)(w.nA,{className:"font-semibold text-orange-700",children:"CUSTOS/DESPESAS OPERACIONAIS"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-orange-700 font-bold",children:q(e.custosOperacionais.total)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-orange-700 bg-orange-100",children:q(j.custosOperacionais)})]}),(0,s.jsxs)(w.Hj,{children:[(0,s.jsx)(w.nA,{className:"font-medium text-red-600 pl-4",children:"(-) Seguro Rastreador"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-red-600",children:q(e.custosOperacionais.seguroRastreador)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-red-600 bg-gray-50",children:q(h.reduce((e,a)=>e+a.custosOperacionais.seguroRastreador,0))})]}),(0,s.jsxs)(w.Hj,{children:[(0,s.jsx)(w.nA,{className:"font-medium text-red-600 pl-4",children:"(-) Manuten\xe7\xe3o"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-red-600",children:q(e.custosOperacionais.manutencao)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-red-600 bg-gray-50",children:q(h.reduce((e,a)=>e+a.custosOperacionais.manutencao,0))})]}),(0,s.jsxs)(w.Hj,{children:[(0,s.jsx)(w.nA,{className:"font-medium text-red-600 pl-4",children:"(-) Taxa de Espa\xe7o"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-red-600",children:q(e.custosOperacionais.taxaEspaco)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-red-600 bg-gray-50",children:q(h.reduce((e,a)=>e+a.custosOperacionais.taxaEspaco,0))})]}),(0,s.jsxs)(w.Hj,{children:[(0,s.jsx)(w.nA,{className:"font-medium text-red-600 pl-4",children:"(-) Royalties"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-red-600",children:q(e.custosOperacionais.royalties)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-red-600 bg-gray-50",children:q(h.reduce((e,a)=>e+a.custosOperacionais.royalties,0))})]}),(0,s.jsxs)(w.Hj,{children:[(0,s.jsx)(w.nA,{className:"font-medium text-red-600 pl-4",children:"(-) Fundo de Marketing"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-red-600",children:q(e.custosOperacionais.fundoMarketing)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-red-600 bg-gray-50",children:q(h.reduce((e,a)=>e+a.custosOperacionais.fundoMarketing,0))})]}),(0,s.jsxs)(w.Hj,{children:[(0,s.jsx)(w.nA,{className:"font-medium text-red-600 pl-4",children:"(-) Sistema de Gest\xe3o"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-red-600",children:q(e.custosOperacionais.sistemaGestao)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-red-600 bg-gray-50",children:q(h.reduce((e,a)=>e+a.custosOperacionais.sistemaGestao,0))})]}),(0,s.jsxs)(w.Hj,{children:[(0,s.jsx)(w.nA,{className:"font-medium text-red-600 pl-4",children:"(-) Honor\xe1rios Cont\xe1beis"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center text-red-600",children:q(e.custosOperacionais.honorariosContabeis)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-red-600 bg-gray-50",children:q(h.reduce((e,a)=>e+a.custosOperacionais.honorariosContabeis,0))})]}),(0,s.jsx)(w.Hj,{children:(0,s.jsx)(w.nA,{colSpan:h.length+2,className:"border-t-2 border-gray-300 p-0"})}),(0,s.jsxs)(w.Hj,{className:"bg-blue-50",children:[(0,s.jsx)(w.nA,{className:"font-bold text-blue-700",children:"Lucro L\xedquido"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center font-bold text-blue-700",children:q(e.lucroLiquido)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-blue-700 bg-blue-100",children:q(j.lucroLiquido)})]}),(0,s.jsxs)(w.Hj,{className:"bg-purple-50",children:[(0,s.jsx)(w.nA,{className:"font-bold text-purple-700",children:"Margem L\xedquida (%)"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center font-bold text-purple-700",children:(0,s.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[e.margemLiquida>=0?(0,s.jsx)(x.A,{className:"h-3 w-3 text-green-600"}):(0,s.jsx)(O.A,{className:"h-3 w-3 text-red-600"}),C(e.margemLiquida)]})},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-purple-700 bg-purple-100",children:(0,s.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[g>=0?(0,s.jsx)(x.A,{className:"h-3 w-3 text-green-600"}):(0,s.jsx)(O.A,{className:"h-3 w-3 text-red-600"}),C(g)]})})]}),(0,s.jsxs)(w.Hj,{className:"bg-green-50",children:[(0,s.jsx)(w.nA,{className:"font-bold text-green-700",children:"Receita L\xedquida por Moto"}),h.map(e=>(0,s.jsx)(w.nA,{className:"text-center font-bold text-green-700",children:q(e.receitaLiquidaPorMoto)},e.monthNumber)),(0,s.jsx)(w.nA,{className:"text-center font-bold text-green-700 bg-green-100",children:q(h.reduce((e,s,r,n)=>{let i=h.reduce((e,s)=>e+new Set(a.filter(e=>{if(!e.data_ultima_mov)return"alugada"===e.status;try{let a=new Date(e.data_ultima_mov),r=a.getFullYear(),l=a.getMonth()+1;if(r===parseInt(t)&&l===s.monthNumber)return!0;if(r<parseInt(t)||r===parseInt(t)&&l<s.monthNumber)return"alugada"===e.status;return!1}catch(e){return!1}}).filter(e=>{var a;return"all"===l||(null==(a=e.franqueado)?void 0:a.trim())===l}).map(e=>e.placa)).size,0),o=h.reduce((e,a)=>e+a.lucroLiquido,0);return i>0?o/i:0},0))})]})]})]})}),(0,s.jsx)("div",{className:"mt-6 flex justify-center",children:(0,s.jsxs)(c.$,{variant:"outline",onClick:()=>m(!d),className:"flex items-center gap-2",children:[(0,s.jsx)(S,{className:"h-4 w-4"}),d?"Ocultar Regras":"Ver Regras de C\xe1lculo"]})}),d&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(M.E,{variant:"outline",className:"text-blue-700 border-blue-300",children:"Informa\xe7\xf5es"}),(0,s.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,s.jsx)("p",{className:"mb-2",children:(0,s.jsx)("strong",{children:"Regras de C\xe1lculo:"})}),(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,s.jsx)("li",{children:(0,s.jsx)("strong",{children:"Custos aplicados apenas em meses com receita:"})}),(0,s.jsx)("li",{children:"Taxa de Espa\xe7o: R$ 250 por moto no m\xeas espec\xedfico"}),(0,s.jsx)("li",{children:"Seguro Rastreador: R$ 139,90 por moto no m\xeas espec\xedfico"}),(0,s.jsx)("li",{children:"Fundo de Marketing: R$ 300 fixo por franqueado"}),(0,s.jsx)("li",{children:"Sistema de Gest\xe3o: R$ 80 fixo por franqueado"}),(0,s.jsx)("li",{children:"Honor\xe1rios Cont\xe1beis: R$ 600 fixo por franqueado"}),(0,s.jsx)("li",{children:"Juros: R$ 212 a cada 10 motos no m\xeas espec\xedfico"}),(0,s.jsx)("li",{children:(0,s.jsx)("strong",{children:"Outros:"})}),(0,s.jsx)("li",{children:"Manuten\xe7\xe3o: Ser\xe1 integrada com base de dados externa"}),(0,s.jsx)("li",{children:"Royalties: 5% sobre receita operacional"}),(0,s.jsx)("li",{children:'Cau\xe7\xe3o: Valor real baseado na coluna "Cau\xe7\xe3o" das motocicletas alugadas/relocadas no m\xeas espec\xedfico'}),(0,s.jsx)("li",{children:"Simples Nacional: 7% sobre receita bruta"})]})]})]})})]})]})}var L=t(79457),D=t(83540),_=t(3401),B=t(96025),H=t(16238),E=t(94517),P=t(83394),I=t(36079);let Z=e=>"R$ ".concat(e.toLocaleString("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0}));function z(e){let{projection:a}=e,t=[{period:"Semanal\n(Atual)",value:a.currentWeekly,color:"hsl(142.1 76.2% 36.3%)",type:"current"},{period:"Mensal\n(Proje\xe7\xe3o)",value:a.projectedMonthly,color:"hsl(221.2 83.2% 53.3%)",type:"projection"},{period:"Trimestral\n(Proje\xe7\xe3o)",value:a.projectedQuarterly,color:"hsl(262.1 83.3% 57.8%)",type:"projection"},{period:"Anual\n(Proje\xe7\xe3o)",value:a.projectedYearly,color:"hsl(346.8 77.2% 49.8%)",type:"projection"}],r=[{scenario:"Pessimista\n(-10%)",value:a.pessimisticMonthly,color:"hsl(0 84.2% 60.2%)"},{scenario:"Realista\n(Atual)",value:a.projectedMonthly,color:"hsl(221.2 83.2% 53.3%)"},{scenario:"Otimista\n(+15%)",value:a.optimisticMonthly,color:"hsl(142.1 76.2% 36.3%)"}],l=e=>{let{x:a,y:t,width:r,value:l}=e;return l>0?(0,s.jsx)("text",{x:a+r/2,y:t,dy:-8,fill:"#374151",fontSize:10,textAnchor:"middle",fontWeight:"bold",children:Z(l)}):null};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Proje\xe7\xf5es por Per\xedodo"}),(0,s.jsx)(D.u,{width:"100%",height:250,children:(0,s.jsxs)(_.E,{data:t,margin:{top:30,right:20,left:20,bottom:20},children:[(0,s.jsx)(B.W,{dataKey:"period",stroke:"#888888",fontSize:11,tickLine:!1,axisLine:!1}),(0,s.jsx)(H.h,{stroke:"#888888",fontSize:11,tickLine:!1,axisLine:!1,tickFormatter:Z}),(0,s.jsx)(E.m,{cursor:{fill:"rgba(128, 128, 128, 0.1)"},contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},formatter:e=>[Z(e),"Receita"],labelFormatter:e=>e.replace("\n"," ")}),(0,s.jsx)(P.y,{dataKey:"value",radius:[4,4,0,0],fill:"hsl(221.2 83.2% 53.3%)",children:(0,s.jsx)(I.Z,{content:(0,s.jsx)(l,{})})})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Cen\xe1rios Mensais"}),(0,s.jsx)(D.u,{width:"100%",height:200,children:(0,s.jsxs)(_.E,{data:r,margin:{top:30,right:20,left:20,bottom:20},children:[(0,s.jsx)(B.W,{dataKey:"scenario",stroke:"#888888",fontSize:11,tickLine:!1,axisLine:!1}),(0,s.jsx)(H.h,{stroke:"#888888",fontSize:11,tickLine:!1,axisLine:!1,tickFormatter:Z}),(0,s.jsx)(E.m,{cursor:{fill:"rgba(128, 128, 128, 0.1)"},contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},formatter:e=>[Z(e),"Receita Mensal"],labelFormatter:e=>e.replace("\n"," ")}),(0,s.jsx)(P.y,{dataKey:"value",radius:[4,4,0,0],fill:"hsl(221.2 83.2% 53.3%)",children:(0,s.jsx)(I.Z,{content:(0,s.jsx)(l,{})})})]})})]})]})}var W=t(87481);let $=new Date().getFullYear();new Date().getMonth();let V=Array.from({length:3},(e,a)=>({value:($-a).toString(),label:($-a).toString()})),G=[{value:"all",label:"Todos os Meses"},{value:"1",label:"Janeiro"},{value:"2",label:"Fevereiro"},{value:"3",label:"Mar\xe7o"},{value:"4",label:"Abril"},{value:"5",label:"Maio"},{value:"6",label:"Junho"},{value:"7",label:"Julho"},{value:"8",label:"Agosto"},{value:"9",label:"Setembro"},{value:"10",label:"Outubro"},{value:"11",label:"Novembro"},{value:"12",label:"Dezembro"}];function J(){var e;let[a,t]=(0,r.useState)([]),[j,f]=(0,r.useState)(!0),[N,v]=(0,r.useState)($.toString()),[y,A]=(0,r.useState)("all"),{toast:w}=(0,W.dj)();(0,r.useEffect)(()=>{f(!0);let e=(0,g.Ef)(e=>{Array.isArray(e)?t(e):(console.warn("Data from subscribeToMotorcycles (financeiro page) was not an array:",e),t([])),f(!1)});return()=>e()},[]);let M=(0,r.useMemo)(()=>{if(j||!Array.isArray(a))return[];let e=a;if("all"!==y){let t=parseInt(y),s=parseInt(N);e=a.filter(e=>{if(!e.data_ultima_mov)return"alugada"===e.status;try{let a=new Date(e.data_ultima_mov),r=a.getFullYear(),l=a.getMonth()+1;if(r===s&&l===t)return!0;if(r<s||r===s&&l<t)return"alugada"===e.status;return!1}catch(e){return!1}})}return e},[a,N,y,j]),k=(0,r.useMemo)(()=>{if(j||!Array.isArray(a))return{kpis:{totalWeeklyRevenue:0,totalMonthlyRevenue:0,averageRevenuePerFranchisee:0,totalRentedMotorcycles:0,financialOccupationRate:0,revenueGrowth:0,averageTicketPerMoto:0,receitaLiquidaPorMoto:0},franchiseeRevenues:[],monthlyAnalysis:[],projection:{currentWeekly:0,projectedMonthly:0,projectedQuarterly:0,projectedYearly:0,optimisticMonthly:0,pessimisticMonthly:0},goalAnalysis:{totalFranchisees:0,franchiseesAboveGoal:0,franchiseesBelowGoal:0,averageOccupation:0,goalAchievementRate:0,topPerformers:[],needsImprovement:[]},topPerformers:[]};let e=parseInt(N),t="all"!==y?parseInt(y):void 0,s=(0,b.l)(M,void 0,e,t),r=(0,b.VH)(M,e,t),l=(0,b.kW)(M,e),n=(0,b.wF)(M,e,t);return{kpis:s,franchiseeRevenues:r,monthlyAnalysis:l,projection:n,goalAnalysis:(0,b.CN)(M,e,t),topPerformers:(0,b.Ad)(M,5,e,t)}},[M,N,y,j]),O=(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(o.l6,{value:N,onValueChange:v,children:[(0,s.jsx)(o.bq,{className:"w-[120px]",children:(0,s.jsx)(o.yv,{placeholder:"Ano"})}),(0,s.jsx)(o.gC,{children:V.map(e=>(0,s.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)(o.l6,{value:y,onValueChange:A,children:[(0,s.jsx)(o.bq,{className:"w-[160px]",children:(0,s.jsx)(o.yv,{placeholder:"M\xeas"})}),(0,s.jsx)(o.gC,{children:G.map(e=>(0,s.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)(c.$,{onClick:()=>{w({title:"Funcionalidade em Desenvolvimento",description:"A exporta\xe7\xe3o de dados financeiros ser\xe1 implementada em breve."})},variant:"default",className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Exportar"]})]});return j?(0,s.jsxs)(l.DashboardLayout,{children:[(0,s.jsx)(n.z,{title:"Dashboard Financeiro",description:"An\xe1lise completa da receita e performance financeira",actions:O}),(0,s.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,s.jsx)("p",{children:"Carregando dados financeiros..."})})]}):(0,s.jsxs)(l.DashboardLayout,{children:[(0,s.jsx)(n.z,{title:"Dashboard Financeiro",description:"all"===y?"An\xe1lise completa da receita e performance financeira - ".concat(N):"An\xe1lise financeira - ".concat(null==(e=G.find(e=>e.value===y))?void 0:e.label," ").concat(N),icon:u.A,iconContainerClassName:"bg-green-600",actions:O}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(R,{kpis:k.kpis,isLoading:j})}),(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsxs)(d.tU,{defaultValue:"overview",className:"space-y-6",children:[(0,s.jsxs)(d.j7,{className:"grid w-full grid-cols-4",children:[(0,s.jsx)(d.Xi,{value:"overview",children:"Vis\xe3o Geral"}),(0,s.jsx)(d.Xi,{value:"dre",children:"DRE"}),(0,s.jsx)(d.Xi,{value:"temporal",children:"An\xe1lise Temporal"}),(0,s.jsx)(d.Xi,{value:"projections",children:"Proje\xe7\xf5es"})]}),(0,s.jsx)(d.av,{value:"overview",className:"space-y-6",children:(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsxs)(i.Zp,{children:[(0,s.jsx)(i.aR,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.A,{className:"h-5 w-5 text-green-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{className:"text-lg",children:"Todos os Franqueados"}),(0,s.jsx)(i.BT,{children:"Receita semanal e proje\xe7\xe3o mensal"})]})]})}),(0,s.jsx)(i.Wu,{children:k.franchiseeRevenues.length>0?(0,s.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-3 pr-2",children:k.franchiseeRevenues.map((e,t)=>{let r,l="all"!==y;return r=l?(0,b.wN)(a,parseInt(N),parseInt(y),e.franqueadoName):4.33*e.weeklyRevenue,(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-green-100 text-green-700 rounded-full font-bold text-sm",children:t+1}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:e.franqueadoName}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[e.motorcycleCount," motos â€¢ ",e.occupationRate.toFixed(1),"% ocupa\xe7\xe3o"]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-bold text-green-600 text-sm",children:["R$ ",e.weeklyRevenue.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),(0,s.jsxs)("p",{className:"text-xs text-blue-600",children:[l?"Real":"Proj."," Mensal: R$ ",r.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]},e.franqueadoName)})}):(0,s.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"Nenhum dado dispon\xedvel"})})]}),(0,s.jsxs)(i.Zp,{children:[(0,s.jsx)(i.aR,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.A,{className:"h-5 w-5 text-blue-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{className:"text-lg",children:"An\xe1lise de Metas"}),(0,s.jsx)(i.BT,{children:"Performance vs. meta de 91% ocupa\xe7\xe3o"})]})]})}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Taxa de Sucesso"}),(0,s.jsxs)("span",{className:"font-bold text-lg text-blue-600",children:[k.goalAnalysis.goalAchievementRate.toFixed(1),"%"]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Acima da Meta"}),(0,s.jsxs)("span",{className:"font-medium text-green-600",children:[k.goalAnalysis.franchiseesAboveGoal," franqueados"]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Abaixo da Meta"}),(0,s.jsxs)("span",{className:"font-medium text-red-600",children:[k.goalAnalysis.franchiseesBelowGoal," franqueados"]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Ocupa\xe7\xe3o M\xe9dia"}),(0,s.jsxs)("span",{className:"font-medium",children:[k.goalAnalysis.averageOccupation.toFixed(1),"%"]})]})]})})]})]})}),(0,s.jsx)(d.av,{value:"dre",className:"space-y-6",children:(0,s.jsx)(T,{motorcycles:a,selectedYear:N})}),(0,s.jsx)(d.av,{value:"temporal",className:"space-y-6",children:(0,s.jsxs)(i.Zp,{children:[(0,s.jsx)(i.aR,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.A,{className:"h-6 w-6 text-green-600"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(i.ZB,{className:"font-headline",children:["Evolu\xe7\xe3o da Receita (",N,")"]}),(0,s.jsx)(i.BT,{children:"An\xe1lise mensal da receita, quantidade de motos e ticket m\xe9dio"})]})]})}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)(L.U,{data:k.monthlyAnalysis,year:parseInt(N)})})]})}),(0,s.jsx)(d.av,{value:"projections",className:"space-y-6",children:(0,s.jsxs)(i.Zp,{children:[(0,s.jsx)(i.aR,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p,{className:"h-6 w-6 text-purple-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.ZB,{className:"font-headline",children:"Proje\xe7\xf5es de Receita"}),(0,s.jsx)(i.BT,{children:"Estimativas baseadas na receita semanal atual"})]})]})}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)(z,{projection:k.projection})})]})})]})})]})}},77070:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])},81203:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(40157).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},85127:(e,a,t)=>{"use strict";t.d(a,{A0:()=>i,BF:()=>o,Hj:()=>c,XI:()=>n,nA:()=>m,nd:()=>d});var s=t(95155),r=t(12115),l=t(59434);let n=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:a,className:(0,l.cn)("w-full caption-bottom text-sm",t),...r})})});n.displayName="Table";let i=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("thead",{ref:a,className:(0,l.cn)("[&_tr]:border-b",t),...r})});i.displayName="TableHeader";let o=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("tbody",{ref:a,className:(0,l.cn)("[&_tr:last-child]:border-0",t),...r})});o.displayName="TableBody",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("tfoot",{ref:a,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r})}).displayName="TableFooter";let c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("tr",{ref:a,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r})});c.displayName="TableRow";let d=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("th",{ref:a,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...r})});d.displayName="TableHead";let m=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("td",{ref:a,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...r})});m.displayName="TableCell",r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("caption",{ref:a,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",t),...r})}).displayName="TableCaption"}},e=>{var a=a=>e(e.s=a);e.O(0,[992,73,207,851,880,508,122,228,168,249,382,925,169,199,321,441,684,358],()=>a(48822)),_N_E=e.O()}]);